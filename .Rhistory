library(GISTools)
library(sp)
library(rgdal)
library(tmap)
library(tbart)
library(scales)
library(ggplot2)
library(sf)
library(repmis)
## Leeds case
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataHPsales.RData?raw=True")
## Qingdao case
ina <- intersect(Qingdao_house, District_Qingdao)
ina$no. <- seq(1,length(ina$House_num),1)
ina$code <- as.character(ina$District) #District no.
zone.list <- sort(unique(array(ina$code)))
ina$pop_hou <- 0
for (item in zone.list) {
zone.set <- (ina$code == item)
inano.list <- ina$no.[zone.set]
for (item1 in inano.list) {
ina$pop_hou[which(ina$no. == item1)] <- (ina$Population[which(ina$no. == item1)])*(ina$House_num[which(ina$no. == item1)]/sum(ina$House_num[zone.set], na.rm = TRUE))
}
}
sum(ina$pop_hou)
sum(District_Qingdao$Population)
sum(ina$House_num)
sum(Qingdao_house$House_num)
res <- intersect(ina, Subdistrict_Qingdao)
zone.list1 <- sort(unique(array(res$Subdistric)))
Subdistrict_Qingdao$Popu_estimate <- 0
for (item in zone.list1) {
zone.set1 <- (res$Subdistric == item)
Subdistrict_Qingdao$Popu_estimate[which(Subdistrict_Qingdao$Subdistric == item)] <- sum(ina$pop_hou[zone.set1], na.rm = TRUE)
}
sum(Subdistrict_Qingdao$Popu_estimate)
sum(Subdistrict_Qingdao$Population)
cor.test(Subdistrict_Qingdao$Population,Subdistrict_Qingdao$Popu_estimate)
Subdistrict_Qingdao$Subdis_household_error_sales_dis <- Subdistrict_Qingdao$Popu_estimate - Subdistrict_Qingdao$Population
table <- cbind(Subdistrict_Qingdao$Subdi_code, Subdistrict_Qingdao$Population, Subdistrict_Qingdao$Popu_estimate,Subdistrict_Qingdao$Subdis_household_error_sales_dis)
colnames(table) <- c("code", "pop", "estimate", "error")
write.csv(table, file = "Subdis_household_error_sales_dis.csv")
getwd()
library(GISTools)
library(sp)
library(rgdal)
library(tmap)
library(scales)
library(ggplot2)
library(rtop)
library(gstat)
library(Rmisc)
library(sf)
library(repmis)
library(GGally)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataHist.RData?raw=True")
library(rgdal)
library(tmap)
library(scales)
library(GISTools)
library(sp)
library(rgdal)
library(tmap)
library(ggplot2)
library(scales)
library(rtop)
library(gstat)
library(Rmisc)
library(sf)
library(repmis)
library(GGally)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataHist.RData?raw=True")
h1 <- ggplot(MSOA_to_LSOA, aes(error)) +
geom_histogram(fill="firebrick3", bins = 30, col = "white") +
facet_wrap( vars(method), ncol = 5)+
#ylab("Count") +
#theme_minimal() +
ylab("A. MSOA to LSOA, Leeds")+
#theme(axis.text.x = element_text(angle = 45, hjust = 0.5, vjust = 0.5))+
#ggtitle("A. MSOA to LSOA, Leeds") +
scale_x_continuous(breaks = 0) +
theme(title = element_text(size = 8, face = "bold"))+
theme(axis.line=element_blank(),
#axis.text=element_blank(),
axis.ticks=element_blank(),
axis.title = element_blank())+
theme(axis.title.y = element_text(angle = 90, size = 8, hjust = 0.5, vjust = 0.5, face = "bold"))
h2<- ggplot(LSOA_to_OA, aes(error)) +
geom_histogram(fill="firebrick3", bins = 30, col = "white") +
facet_wrap( vars(method), ncol = 5)+
#theme_minimal() +
ylab("B. LSOA to OA, Leeds")+
#ggtitle("B. LSOA to OA, Leeds") +
#theme(title = element_text(size = 8, face = "bold"))+
scale_x_continuous(breaks = 0) +
theme(axis.line=element_blank(),
#axis.text=element_blank(),
strip.text.x = element_blank(),
axis.ticks=element_blank(),
axis.title = element_blank())+
theme(axis.title.y = element_text(angle = 90, size = 8, hjust = 0.5, vjust = 0.5, face = "bold"))
h3 <- ggplot(MSOA_to_OA, aes(error)) +
geom_histogram(fill="firebrick3", bins = 30, col = "white") +
facet_wrap( vars(method), ncol = 5)+
#theme_minimal() +
ylab("C. MSOA to OA, Leeds")+
#ggtitle("C. MSOA to OA, Leeds") +
#theme(title = element_text(size = 8, face = "bold"))+
scale_x_continuous(breaks = 0) +
theme(axis.line=element_blank(),
#axis.text=element_blank(),
strip.text.x = element_blank(),
axis.ticks=element_blank(),
axis.title = element_blank())+
theme(axis.title.y = element_text(angle = 90, size = 8, hjust = 0.5, vjust = 0.5, face = "bold"))
h4 <- ggplot(Dis_to_Subdis, aes(error)) +
geom_histogram(fill="firebrick3", bins = 30, col = "white") +
facet_wrap( vars(method), ncol = 5)+
#theme_minimal() +
ylab("D. District to Subdistrict, Qingdao")+
#ggtitle("D. District to Subdistrict, Qingdao") +
scale_x_continuous(breaks = 0) +
theme(title = element_text(size = 8, face = "bold"))+
theme(axis.line=element_blank(),
#axis.text=element_blank(),
axis.ticks=element_blank(),
strip.text.x = element_blank(),
axis.title = element_blank())+
theme(axis.title.y = element_text(angle = 90, size = 8, hjust = 0.5, vjust = 0.5, face = "bold"))
multiplot(h1, h2, h3, h4, cols = 1)
MSOA_to_LSOA
