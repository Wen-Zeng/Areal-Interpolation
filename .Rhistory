library(car)
library(Rmisc)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataCumsum.RData?raw=True")
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataCumsum.RData?raw=True")
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataCumsum.RData?raw=True")
library(GISTools)
library(sp)
library(rgdal)
library(tmap)
library(scales)
library(ggplot2)
library(rtop)
library(gstat)
library(automap)
library(deldir)
library(raster)
library(sf)
library(car)
library(Rmisc)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataCumsum.RData?raw=True")
library(GISTools)
library(sp)
library(rgdal)
library(tmap)
library(scales)
library(ggplot2)
library(rtop)
library(gstat)
library(automap)
library(deldir)
library(raster)
library(sf)
library(car)
library(Rmisc)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataCumsum.RData?raw=True")
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataCumsum.RData?raw=True")
library(repmis)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataCumsum.RData?raw=True")
g1 <- ggplot()+
geom_line(data = Cumsum_LSOA_to_OA,aes(x = Cumsum_LSOA_to_OA$Household_sales_abs,y = Cumsum_LSOA_to_OA$Household_sales.1, colour  = "HP_sales"),size=1) +
geom_point(data = Cumsum_LSOA_to_OA,aes(x = Cumsum_LSOA_to_OA$Household_sales_abs,y = Cumsum_LSOA_to_OA$Household_sales.1, colour  = "HP_sales"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_LSOA_to_OA,aes(x = Cumsum_LSOA_to_OA$Household_census_abs,y = Cumsum_LSOA_to_OA$Household_census.1,colour  = "HP_census"),size=1) +
geom_point(data = Cumsum_LSOA_to_OA,aes(x = Cumsum_LSOA_to_OA$Household_census_abs,y = Cumsum_LSOA_to_OA$Household_census.1,colour  = "HP_census"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_LSOA_to_OA,aes(x = Cumsum_LSOA_to_OA$Dasymetric_abs,y = Cumsum_LSOA_to_OA$Dasymetric.1, colour = "Dasymetric"),size=1) +
geom_point(data = Cumsum_LSOA_to_OA,aes(x = Cumsum_LSOA_to_OA$Dasymetric_abs,y = Cumsum_LSOA_to_OA$Dasymetric.1, colour = "Dasymetric"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_LSOA_to_OA,aes(x = Cumsum_LSOA_to_OA$Network_abs,y = Cumsum_LSOA_to_OA$Network.1, colour = "Network"),size=1) +
geom_point(data = Cumsum_LSOA_to_OA,aes(x = Cumsum_LSOA_to_OA$Network_abs,y = Cumsum_LSOA_to_OA$Network.1, colour = "Network"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_LSOA_to_OA,aes(x = Cumsum_LSOA_to_OA$Areal_weight_abs,y = Cumsum_LSOA_to_OA$Areal_weight.1, colour = "Areal_weight"),size=1) +
geom_point(data = Cumsum_LSOA_to_OA,aes(x = Cumsum_LSOA_to_OA$Areal_weight_abs,y = Cumsum_LSOA_to_OA$Areal_weight.1, colour = "Areal_weight"),size=3,alpha = 0.2) +
#scale_x_continuous(name = "Absolute Error") +
#scale_y_continuous(name = "Cumulative Percentage") +
# 修改X轴和y轴标签的大小、字体、颜色、加粗、位置、角度
xlab("Absolute Error") + theme(axis.title.x = element_text(size = 15, color = "black", face = "bold", vjust = 0.5, hjust = 0.5)) +
#修改 X 轴刻度文字的大小、字体、颜色、加粗、位置、角度：
theme(axis.text.x = element_text(size = 10, color = "black", face = "bold")) +
ylab("Cumulative Percentage") + theme(axis.title.y = element_text(size = 15, color = "black", face = "bold", vjust = 0.5, hjust = 0.5)) +
scale_x_continuous(breaks=seq(0, 1500, 300)) +
#y轴转换成百分比形式,并设置刻度间距
scale_y_continuous(labels=percent, breaks=seq(0, 1, 0.2)) +
theme(axis.text.y = element_text(size = 10, color = "black", face = "bold")) +
#添加坐标轴横竖线
theme(axis.line = element_line(colour = "black")) +
#添加与80%平行的横线
geom_hline(aes(yintercept = 0.8), colour="#BB0000", linetype="dashed") +
#change lengend's colour
scale_color_brewer(palette = 'Set2', direction = 1, breaks = c('HP_sales','HP_census','Dasymetric','Network','Areal_weight')) +
#设置标题，face="bold"加粗
theme(legend.title = element_text(color="black", size=16, face="bold"),legend.position = 'bottom') +
#改变图例标题
labs(color='Methods: ')   +
theme(legend.text = element_text(color="black", size = 10, face = "bold")) +   ##设置图例标签文字
theme(panel.grid =element_blank(), panel.background = element_blank()) +   ## 删去网格线和背景颜色
ggtitle('C. LSOA to OA in Leeds, UK') +
#图例两行显示
guides(colour = guide_legend(nrow = 2))
g2 <- ggplot()+
geom_line(data = Cumsum_MSOA_to_LSOA,aes(x = Cumsum_MSOA_to_LSOA$Household_sales_abs,y = Cumsum_MSOA_to_LSOA$Household_sales.1, colour  = "HP_sales"),size=1) +
geom_point(data = Cumsum_MSOA_to_LSOA,aes(x = Cumsum_MSOA_to_LSOA$Household_sales_abs,y = Cumsum_MSOA_to_LSOA$Household_sales.1, colour  = "HP_sales"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_MSOA_to_LSOA,aes(x = Cumsum_MSOA_to_LSOA$Household_census_abs,y = Cumsum_MSOA_to_LSOA$Household_census.1,colour  = "HP_census"),size=1) +
geom_point(data = Cumsum_MSOA_to_LSOA,aes(x = Cumsum_MSOA_to_LSOA$Household_census_abs,y = Cumsum_MSOA_to_LSOA$Household_census.1,colour  = "HP_census"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_MSOA_to_LSOA,aes(x = Cumsum_MSOA_to_LSOA$Dasymetric_abs,y = Cumsum_MSOA_to_LSOA$Dasymetric.1, colour = "Dasymetric"),size=1) +
geom_point(data = Cumsum_MSOA_to_LSOA,aes(x = Cumsum_MSOA_to_LSOA$Dasymetric_abs,y = Cumsum_MSOA_to_LSOA$Dasymetric.1, colour = "Dasymetric"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_MSOA_to_LSOA,aes(x = Cumsum_MSOA_to_LSOA$Network_abs,y = Cumsum_MSOA_to_LSOA$Network.1, colour = "Network"),size=1) +
geom_point(data = Cumsum_MSOA_to_LSOA,aes(x = Cumsum_MSOA_to_LSOA$Network_abs,y = Cumsum_MSOA_to_LSOA$Network.1, colour = "Network"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_MSOA_to_LSOA,aes(x = Cumsum_MSOA_to_LSOA$Areal_weight_abs,y = Cumsum_MSOA_to_LSOA$Areal_weight.1, colour = "Areal_weight"),size=1) +
geom_point(data = Cumsum_MSOA_to_LSOA,aes(x = Cumsum_MSOA_to_LSOA$Areal_weight_abs,y = Cumsum_MSOA_to_LSOA$Areal_weight.1, colour = "Areal_weight"),size=3,alpha = 0.2) +
#scale_x_continuous(name = "Absolute Error") +
#scale_y_continuous(name = "Cumulative Percentage") +
# 修改X轴和y轴标签的大小、字体、颜色、加粗、位置、角度
xlab("Absolute Error") + theme(axis.title.x = element_text(size = 15, color = "black", face = "bold", vjust = 0.5, hjust = 0.5)) +
#修改 X 轴刻度文字的大小、字体、颜色、加粗、位置、角度：
theme(axis.text.x = element_text(size = 10, color = "black", face = "bold")) +
ylab("Cumulative Percentage") + theme(axis.title.y = element_text(size = 15, color = "black", face = "bold", vjust = 0.5, hjust = 0.5)) +
scale_x_continuous(breaks=seq(0, 4000, 800)) +
#y轴转换成百分比形式,并设置刻度间距
scale_y_continuous(labels=percent, breaks=seq(0, 1, 0.2)) +
theme(axis.text.y = element_text(size = 10, color = "black", face = "bold")) +
#添加坐标轴横竖线
theme(axis.line = element_line(colour = "black")) +
#添加与80%平行的横线
geom_hline(aes(yintercept = 0.8), colour="#BB0000", linetype="dashed") +
#change lengend's colour
scale_color_brewer(palette = 'Set2', direction = 1, breaks = c('HP_sales','HP_census','Dasymetric','Network','Areal_weight')) +
#设置标题，face="bold"加粗
theme(legend.title = element_text(color="black", size=16, face="bold"),legend.position = 'bottom') +
#改变图例标题
labs(color='Methods: ')   +
theme(legend.text = element_text(color="black", size = 10, face = "bold")) +   ##设置图例标签文字
theme(panel.grid =element_blank(), panel.background = element_blank())+   ## 删去网格线和背景颜色
ggtitle('A. MSOA to LSOA in Leeds, UK') +
#图例两行显示
guides(colour = guide_legend(nrow = 2))
g3 <- ggplot()+
geom_line(data = Cumsum_MSOA_to_OA,aes(x = Cumsum_MSOA_to_OA$Household_sales_abs,y = Cumsum_MSOA_to_OA$Household_sales.1, colour  = "HP_sales"),size=1) +
geom_point(data = Cumsum_MSOA_to_OA,aes(x = Cumsum_MSOA_to_OA$Household_sales_abs,y = Cumsum_MSOA_to_OA$Household_sales.1, colour  = "HP_sales"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_MSOA_to_OA,aes(x = Cumsum_MSOA_to_OA$Household_census_abs,y = Cumsum_MSOA_to_OA$Household_census.1,colour  = "HP_census"),size=1) +
geom_point(data = Cumsum_MSOA_to_OA,aes(x = Cumsum_MSOA_to_OA$Household_census_abs,y = Cumsum_MSOA_to_OA$Household_census.1,colour  = "HP_census"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_MSOA_to_OA,aes(x = Cumsum_MSOA_to_OA$Dasymetric_abs,y = Cumsum_MSOA_to_OA$Dasymetric.1, colour = "Dasymetric"),size=1) +
geom_point(data = Cumsum_MSOA_to_OA,aes(x = Cumsum_MSOA_to_OA$Dasymetric_abs,y = Cumsum_MSOA_to_OA$Dasymetric.1, colour = "Dasymetric"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_MSOA_to_OA,aes(x = Cumsum_MSOA_to_OA$Network_abs,y = Cumsum_MSOA_to_OA$Network.1, colour = "Network"),size=1) +
geom_point(data = Cumsum_MSOA_to_OA,aes(x = Cumsum_MSOA_to_OA$Network_abs,y = Cumsum_MSOA_to_OA$Network.1, colour = "Network"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_MSOA_to_OA,aes(x = Cumsum_MSOA_to_OA$Areal_weight_abs,y = Cumsum_MSOA_to_OA$Areal_weight.1, colour = "Areal_weight"),size=1) +
geom_point(data = Cumsum_MSOA_to_OA,aes(x = Cumsum_MSOA_to_OA$Areal_weight_abs,y = Cumsum_MSOA_to_OA$Areal_weight.1, colour = "Areal_weight"),size=3,alpha = 0.2) +
#scale_x_continuous(name = "Absolute Error") +
#scale_y_continuous(name = "Cumulative Percentage") +
# 修改X轴和y轴标签的大小、字体、颜色、加粗、位置、角度
xlab("Absolute Error") + theme(axis.title.x = element_text(size = 15, color = "black", face = "bold", vjust = 0.5, hjust = 0.5)) +
#修改 X 轴刻度文字的大小、字体、颜色、加粗、位置、角度：
theme(axis.text.x = element_text(size = 10, color = "black", face = "bold")) +
ylab("Cumulative Percentage") + theme(axis.title.y = element_text(size = 15, color = "black", face = "bold", vjust = 0.5, hjust = 0.5)) +
scale_x_continuous(breaks=seq(0, 5000, 500)) +
#y轴转换成百分比形式,并设置刻度间距
scale_y_continuous(labels=percent, breaks=seq(0, 1, 0.2)) +
theme(axis.text.y = element_text(size = 10, color = "black", face = "bold")) +
#添加坐标轴横竖线
theme(axis.line = element_line(colour = "black")) +
#添加与80%平行的横线
geom_hline(aes(yintercept = 0.8), colour="#BB0000", linetype="dashed") +
#change lengend's colour
scale_color_brewer(palette = 'Set2', direction = 1, breaks = c('HP_sales','HP_census','Dasymetric','Network','Areal_weight')) +
#设置标题，face="bold"加粗
theme(legend.title = element_text(color="black", size=16, face="bold"),legend.position = 'bottom') +
#改变图例标题
labs(color='Methods: ')   +
theme(legend.text = element_text(color="black", size = 10, face = "bold")) +   ##设置图例标签文字
theme(panel.grid =element_blank(), panel.background = element_blank())+   ## 删去网格线和背景颜色
ggtitle('B. MSOA to OA in Leeds, UK') +
#图例两行显示
guides(colour = guide_legend(nrow = 2))
g4 <- ggplot()+
geom_line(data = Cumsum_Dis_to_Subdis,aes(x = Cumsum_Dis_to_Subdis$Household_sales_abs,y = Cumsum_Dis_to_Subdis$Household_sales.1, colour  = "HP_sales"),size=1) +
geom_point(data = Cumsum_Dis_to_Subdis,aes(x = Cumsum_Dis_to_Subdis$Household_sales_abs,y = Cumsum_Dis_to_Subdis$Household_sales.1, colour  = "HP_sales"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_Dis_to_Subdis,aes(x = Cumsum_Dis_to_Subdis$Household_census_abs,y = Cumsum_Dis_to_Subdis$Household_census.1,colour  = "HP_census"),size=1) +
geom_point(data = Cumsum_Dis_to_Subdis,aes(x = Cumsum_Dis_to_Subdis$Household_census_abs,y = Cumsum_Dis_to_Subdis$Household_census.1,colour  = "HP_census"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_Dis_to_Subdis,aes(x = Cumsum_Dis_to_Subdis$Dasymetric_abs,y = Cumsum_Dis_to_Subdis$Dasymetric.1, colour = "Dasymetric"),size=1) +
geom_point(data = Cumsum_Dis_to_Subdis,aes(x = Cumsum_Dis_to_Subdis$Dasymetric_abs,y = Cumsum_Dis_to_Subdis$Dasymetric.1, colour = "Dasymetric"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_Dis_to_Subdis,aes(x = Cumsum_Dis_to_Subdis$Network_abs,y = Cumsum_Dis_to_Subdis$Network.1, colour = "Network"),size=1) +
geom_point(data = Cumsum_Dis_to_Subdis,aes(x = Cumsum_Dis_to_Subdis$Network_abs,y = Cumsum_Dis_to_Subdis$Network.1, colour = "Network"),size=3,alpha = 0.2) +
geom_line(data = Cumsum_Dis_to_Subdis,aes(x = Cumsum_Dis_to_Subdis$Areal_weight_abs,y = Cumsum_Dis_to_Subdis$Areal_weight.1, colour = "Areal_weight"),size=1) +
geom_point(data = Cumsum_Dis_to_Subdis,aes(x = Cumsum_Dis_to_Subdis$Areal_weight_abs,y = Cumsum_Dis_to_Subdis$Areal_weight.1, colour = "Areal_weight"),size=3,alpha = 0.2) +
#scale_x_continuous(name = "Absolute Error") +
#scale_y_continuous(name = "Cumulative Percentage") +
# 修改X轴和y轴标签的大小、字体、颜色、加粗、位置、角度
xlab("Absolute Error") + theme(axis.title.x = element_text(size = 15, color = "black", face = "bold", vjust = 0.5, hjust = 0.5)) +
#修改 X 轴刻度文字的大小、字体、颜色、加粗、位置、角度：
theme(axis.text.x = element_text(size = 10, color = "black", face = "bold")) +
ylab("Cumulative Percentage") + theme(axis.title.y = element_text(size = 15, color = "black", face = "bold", vjust = 0.5, hjust = 0.5)) +
#scale_x_continuous(breaks=seq(0, 5000, 500)) +
#y轴转换成百分比形式,并设置刻度间距
scale_y_continuous(labels=percent, breaks=seq(0, 1, 0.2)) +
theme(axis.text.y = element_text(size = 10, color = "black", face = "bold")) +
#添加坐标轴横竖线
theme(axis.line = element_line(colour = "black")) +
#添加与80%平行的横线
geom_hline(aes(yintercept = 0.8), colour="#BB0000", linetype="dashed") +
#change lengend's colour
scale_color_brewer(palette = 'Set2', direction = 1, breaks = c('HP_sales','HP_census','Dasymetric','Network','Areal_weight')) +
#设置标题，face="bold"加粗
theme(legend.title = element_text(color="black", size=16, face="bold"),legend.position = 'bottom') +
#改变图例标题
labs(color='Methods: ')   +
theme(legend.text = element_text(color="black", size = 10, face = "bold")) +   ##设置图例标签文字
theme(panel.grid =element_blank(), panel.background = element_blank())+   ## 删去网格线和背景颜色
ggtitle('D. District to Subdistrict in Qingdao, China') +
#图例两行显示
guides(colour = guide_legend(nrow = 2))
multiplot(g2, g1, g3, g4, cols = 2)
library(GISTools)
library(sp)
library(rgdal)
library(rgeos)
library(tmap)
library(scales)
library(ggplot2)
library(rtop)
library(gstat)
library(automap)
library(pycno)
library(deldir)
library(raster)
library(sf)
#Load data
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataNet.RData?raw=True")
## Leeds case
#check the population
sum(Leeds_MSOA$Population, na.rm = T)
#Load data
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataNet.RData?raw=True")
library(repmis)
#Load data
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataNet.RData?raw=True")
## Leeds case
#check the population
sum(Leeds_MSOA$Population, na.rm = T)
sum(Leeds_LSOA$pop, na.rm = T)
sum(Leeds_OA$pop, na.rm = T)
class(Leeds_MSOA)
library(GISTools)
library(sp)
library(rgdal)
library(rgeos)
library(tmap)
library(ggplot2)
library(scales)
library(rtop)
library(gstat)
library(automap)
library(pycno)
library(deldir)
library(raster)
library(sf)
library(repmis)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataDasy.RData?raw=True")
class(Leeds_LSOA)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataHPsales.RData?raw=True")
class(Leeds_OA)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataAW.RData?raw=True")
class(Leeds_OA)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataHPcensus.RData?raw=True")
class(Leeds_OA)
library(GISTools)
library(sp)
library(rgdal)
library(tmap)
library(scales)
library(ggplot2)
library(rtop)
library(gstat)
library(automap)
library(deldir)
library(raster)
library(sf)
library(repmis)
library(gclus)
library(raster)
library(ggplot2)
library(GGally)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataAW.RData?raw=True")
## Leeds case
#check the population and household count
sum(Leeds_MSOA$Population, na.rm = T)
sum(Leeds_LSOA$pop, na.rm = T)
sum(Leeds_OA$pop, na.rm = T)
sum(Leeds_MSOA$hou_num)
sum(Leeds_LSOA$hou_num)
sum(Leeds_OA$hou_num)
#MSOA to LSOA
ina <- intersect(Leeds_LSOA, Leeds_MSOA)
ina$Area <- 0
ina$Area <- area(ina)
ina$no. <- seq(1,length(ina$pop),1)
zone.list <- sort(unique(array(ina$geo_code)))
ina$pops <- 0
ina$area_weight <- 0
for (item in zone.list) {
zone.set <- (ina$geo_code == item)
inano.list <- ina$no.[zone.set]
for (item1 in inano.list) {
ina$area_weight[which(ina$no. == item1)] <- ina$Area[which(ina$no. == item1)]/sum(ina$Area[zone.set], na.rm = TRUE)
}
for (item2 in inano.list) {
ina$pops[which(ina$no. == item2)] = ina$Population[which(ina$no. == item2)]*ina$area_weight[which(ina$no. == item2)]
}
}
sum(ina$pops)
sum(Leeds_MSOA$Population)
Leeds_LSOA$pop_estimate <-0
zone.list <- sort(unique(array(ina$code)))
for (item in zone.list){
Leeds_LSOA$pop_estimate[which(Leeds_LSOA$code == item)] <- ina$pops[which(ina$code == item)]
}
sum(Leeds_LSOA$pop_estimate)
sum(Leeds_LSOA$pop)
cor.test(Leeds_LSOA$pop,Leeds_LSOA$pop_estimate)
library(GISTools)
library(sp)
library(rgdal)
library(tmap)
library(scales)
library(ggplot2)
library(gstat)
library(rtop)
library(automap)
library(pycno)
library(deldir)
library(raster)
library(sf)
library(repmis)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataHPcensus.RData?raw=True")
## Leeds case
#check the population and household count
sum(Leeds_MSOA$Population, na.rm = T)
sum(Leeds_LSOA$pop, na.rm = T)
sum(Leeds_OA$pop, na.rm = T)
sum(Leeds_MSOA$hou_num)
sum(Leeds_LSOA$hou_num)
sum(Leeds_OA$hou_num)
#MSOA to LSOA
Leeds_MSOA$fig <- seq(1,length(Leeds_MSOA$Population),1)
Leeds_LSOA$no. <- seq(1,length(Leeds_LSOA$code),1)
px <- CRS(proj4string(Leeds_LSOA))
res <- SpatialPointsDataFrame(coordinates(Leeds_LSOA),proj4string=px,data.frame(pop=Leeds_LSOA$pop,hou_num=Leeds_LSOA$hou_num,no.=Leeds_LSOA$no.))
ina <- intersect(res, Leeds_MSOA)
ina$code <- as.character(ina$geo_code) #MSOA no.
zone.list <- sort(unique(array(ina$code)))
Leeds_LSOA$Pop_estimate <- 0
ina$pop_hou <- 0
for (item in zone.list) {
zone.set <- (ina$code == item)
inano.list <- ina$no.[zone.set]
for (item1 in inano.list) {
ina$pop_hou[which(ina$no. == item1)] <- (ina$Population[item1])*(ina$hou_num[item1]/sum(ina$hou_num[zone.set], na.rm = TRUE))
Leeds_LSOA$Pop_estimate[which(Leeds_LSOA$no. == item1)] <- ina$pop_hou[which(ina$no. == item1)]
}
}
sum(Leeds_LSOA$Pop_estimate)
sum(Leeds_LSOA$pop)
cor.test(Leeds_LSOA$pop,Leeds_LSOA$Pop_estimate)
library(GISTools)
library(sp)
library(rgdal)
library(tmap)
library(scales)
library(ggplot2)
library(rtop)
library(gstat)
library(automap)
library(deldir)
library(raster)
library(sf)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataDasy.RData?raw=True")
library(repmis)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataDasy.RData?raw=True")
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataErrormap.RData?raw=True")
par(mar=c(0,0,0,0))
#MSOA to LSOA
tm_shape(Error_MSOA_to_LSOA) +
tm_fill(col='HP_census',,title='Error',palette='-RdBu', breaks = c(-2200,-500,-100,0,100,500,4700), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_MSOA_to_LSOA) +
tm_fill(col='HP_sales',title='Error',palette='-RdBu', breaks = c(-2200,-500,-100,0,100,500,4700), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_MSOA_to_LSOA) +
tm_fill(col='Dasymetric',title='Error',palette='-RdBu', breaks = c(-2200,-500,-100,0,100,500,4700), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_MSOA_to_LSOA) +
tm_fill(col='Network',title='Error',palette='-RdBu', breaks = c(-2200,-500,-100,0,100,500,4700), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_MSOA_to_LSOA) +
tm_fill(col='Areal_weighted',title='Error',palette='-RdBu', breaks = c(-2200,-500,-100,0,100,500,4700), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
#LSOA to OA
tm_shape(Error_LSOA_to_OA) +
tm_fill(col='HP_census',,title='Error',palette='-RdBu', breaks = c(-1300,-100,-30,0,30,100,1650), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_LSOA_to_OA) +
tm_fill(col='HP_sales',title='Error',palette='-RdBu', breaks = c(-1300,-100,-30,0,30,100,1650), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_LSOA_to_OA) +
tm_fill(col='Dasymetric',title='Error',palette='-RdBu', breaks = c(-1300,-100,-30,0,30,100,1650), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_LSOA_to_OA) +
tm_fill(col='Network',title='Error',palette='-RdBu', breaks = c(-1300,-100,-30,0,30,100,1650), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_LSOA_to_OA) +
tm_fill(col='Areal_weighted',title='Error',palette='-RdBu', breaks = c(-1300,-100,-30,0,30,100,1650), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
#MSOA to OA
tm_shape(Error_MSOA_to_OA) +
tm_fill(col='HP_census',,title='Error',palette='-RdBu', breaks = c(-2100,-100,-30,0,30,100,4200), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_MSOA_to_OA) +
tm_fill(col='HP_sales',title='Error',palette='-RdBu', breaks = c(-2100,-100,-30,0,30,100,4200), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_MSOA_to_OA) +
tm_fill(col='Dasymetric',title='Error',palette='-RdBu', breaks = c(-2100,-100,-30,0,30,100,4200), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
Error_MSOA_to_OA$HP_census
tm_shape(Error_LSOA_to_OA) +
tm_fill(col='Areal_weighted',title='Error',palette='-RdBu', breaks = c(-1300,-100,-30,0,30,100,1650), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
library(GISTools)
library(sp)
library(rgdal)
library(tmap)
library(scales)
library(ggplot2)
library(rtop)
library(gstat)
library(automap)
library(deldir)
library(raster)
library(sf)
library(repmis)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataErrormap.RData?raw=True")
par(mar=c(0,0,0,0))
#MSOA to LSOA
tm_shape(Error_MSOA_to_LSOA) +
tm_fill(col='HP_census',,title='Error',palette='-RdBu', breaks = c(-2200,-500,-100,0,100,500,4700), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_MSOA_to_LSOA) +
tm_fill(col='HP_sales',title='Error',palette='-RdBu', breaks = c(-2200,-500,-100,0,100,500,4700), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_MSOA_to_LSOA) +
tm_fill(col='Dasymetric',title='Error',palette='-RdBu', breaks = c(-2200,-500,-100,0,100,500,4700), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_MSOA_to_LSOA) +
tm_fill(col='Network',title='Error',palette='-RdBu', breaks = c(-2200,-500,-100,0,100,500,4700), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_MSOA_to_LSOA) +
tm_fill(col='Areal_weighted',title='Error',palette='-RdBu', breaks = c(-2200,-500,-100,0,100,500,4700), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
#LSOA to OA
tm_shape(Error_LSOA_to_OA) +
tm_fill(col='HP_census',,title='Error',palette='-RdBu', breaks = c(-1300,-100,-30,0,30,100,1650), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
Error_LSOA_to_OA$HP_census
library(GISTools)
library(sp)
library(rgdal)
library(scales)
library(tmap)
library(ggplot2)
library(rtop)
library(automap)
library(gstat)
library(deldir)
library(raster)
library(sf)
library(repmis)
# Load Data
source_data("https://github.com/Wen-Zeng/Areal-Interpolation/blob/master/DataErrormap.RData?raw=True")
par(mar=c(0,0,0,0))
#LSOA to OA
tm_shape(Error_LSOA_to_OA) +
tm_fill(col='HP_census',,title='Error',palette='-RdBu', breaks = c(-1300,-100,-30,0,30,100,1650), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_LSOA_to_OA) +
tm_fill(col='HP_sales',title='Error',palette='-RdBu', breaks = c(-1300,-100,-30,0,30,100,1650), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_LSOA_to_OA) +
tm_fill(col='Dasymetric',title='Error',palette='-RdBu', breaks = c(-1300,-100,-30,0,30,100,1650), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_LSOA_to_OA) +
tm_fill(col='Network',title='Error',palette='-RdBu', breaks = c(-1300,-100,-30,0,30,100,1650), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_LSOA_to_OA) +
tm_fill(col='Areal_weighted',title='Error',palette='-RdBu', breaks = c(-1300,-100,-30,0,30,100,1650), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
#MSOA to OA
tm_shape(Error_MSOA_to_OA) +
tm_fill(col='HP_census',,title='Error',palette='-RdBu', breaks = c(-2100,-100,-30,0,30,100,4200), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_MSOA_to_OA) +
tm_fill(col='HP_sales',title='Error',palette='-RdBu', breaks = c(-2100,-100,-30,0,30,100,4200), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_MSOA_to_OA) +
tm_fill(col='Network',title='Error',palette='-RdBu', breaks = c(-2100,-100,-30,0,30,100,4200), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
tm_shape(Error_MSOA_to_OA) +
tm_fill(col='Areal_weighted',title='Error',palette='-RdBu', breaks = c(-2100,-100,-30,0,30,100,4200), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.show = FALSE)
#Legend
tm_shape(Error_MSOA_to_LSOA) +
tm_fill(col='HP_census',,title='Error',palette='-RdBu', breaks = c(-2200,-500,-100,0,100,500,4700), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.only=T)
tm_shape(Error_LSOA_to_OA) +
tm_fill(col='HP_census',,title='Error',palette='-RdBu', breaks = c(-1300,-100,-30,0,30,100,1650), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.only=T)
tm_shape(Error_MSOA_to_OA) +
tm_fill(col='HP_census',,title='Error',palette='-RdBu', breaks = c(-2100,-100,-30,0,30,100,4200), legend.is.portrait=TRUE, midpoint = NA) +
tm_layout(frame = F,legend.only=T)
